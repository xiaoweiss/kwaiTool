name: 打包快手账号管理工具 (备选方案)

on:
  workflow_dispatch: # 仅允许手动触发

jobs:
  build-windows:
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@v3

      - name: 设置Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.10"
          cache: "pip"

      - name: 安装依赖
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt
          pip install pyinstaller
          python -m playwright install

      - name: 打包应用程序
        run: |
          python package.py

      - name: 创建ZIP压缩包
        run: |
          echo "创建ZIP压缩包..."
          Compress-Archive -Path dist/* -DestinationPath 快手账号管理工具.zip

      - name: 显示构建结果
        run: |
          echo "打包完成！"
          echo "构建结果已压缩为: 快手账号管理工具.zip"
          echo "请通过远程桌面或其他方式从运行器获取文件。"
          echo "工作流完成后，运行器将保持活动状态30分钟，您可以在此期间连接并获取文件。"

      # 保持运行器活动，以便可以手动获取文件
      - name: 保持运行器活动
        run: |
          echo "运行器将保持活动状态30分钟..."
          echo "您可以通过以下方式获取文件:"
          echo "1. 使用远程桌面连接到运行器"
          echo "2. 文件位置: ${{ github.workspace }}\快手账号管理工具.zip"
          echo "3. 或者 ${{ github.workspace }}\dist 目录"
          Start-Sleep -Seconds 1800 # 30分钟
